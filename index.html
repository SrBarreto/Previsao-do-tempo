<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" type="image/x-icon" href="favicon.ico" />
    <title>Previs√£o do Tempo</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
      crossorigin="anonymous"
    />
    <style>
      body {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        overflow-x: hidden;
      }

      .weather-container {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 20px;
        padding: 40px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        margin-top: 30px;
      }

      .character-display {
        text-align: center;
        font-size: 120px;
        margin: 30px 0;
        min-height: 150px;
        animation: fadeIn 0.5s ease-in;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: scale(0.8);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }

      @keyframes bounce {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-20px);
        }
      }

      @keyframes shake {
        0%,
        100% {
          transform: rotate(0deg);
        }
        25% {
          transform: rotate(-5deg);
        }
        75% {
          transform: rotate(5deg);
        }
      }

      @keyframes rain {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(10px);
        }
      }

      .hot {
        animation: bounce 1.5s infinite;
      }

      .cold {
        animation: shake 1s infinite;
      }

      .rainy {
        animation: rain 0.8s infinite;
      }

      .info-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 15px;
        padding: 20px;
        margin: 15px 0;
        border-left: 5px solid #ffc107;
      }

      .weather-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-top: 20px;
      }

      .weather-item {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        color: white;
        padding: 20px;
        border-radius: 15px;
        text-align: center;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease;
      }

      .weather-item:hover {
        transform: translateY(-5px);
      }

      .weather-item.cold {
        background: linear-gradient(135deg, #667eea 0%, #4facfe 100%);
      }

      .weather-item.rainy {
        background: linear-gradient(135deg, #667eea 0%, #7b68ee 100%);
      }

      .time {
        font-size: 14px;
        opacity: 0.9;
        margin-bottom: 10px;
      }

      .temp {
        font-size: 28px;
        font-weight: bold;
        margin: 10px 0;
      }

      .rain {
        font-size: 14px;
        opacity: 0.9;
      }

      .title {
        color: #667eea;
        font-weight: bold;
        margin-bottom: 30px;
        font-size: 32px;
      }

      .form-control,
      .form-label {
        color: #333;
      }

      .btn-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
        padding: 10px 30px;
        font-size: 16px;
        border-radius: 10px;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }

      .btn-primary:hover {
        transform: scale(1.05);
        box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
      }

      .status-text {
        font-size: 18px;
        font-weight: bold;
        color: #667eea;
        margin-top: 20px;
      }
    </style>
    <script>
      function getWeatherStatus(temp, rain) {
        if (rain > 0.1) return "rainy";
        if (temp < 10) return "cold";
        if (temp >= 25) return "hot";
        return "normal";
      }

      function getCharacter(status) {
        const characters = {
          hot: "‚òÄÔ∏èüòÜ",
          cold: "‚ùÑÔ∏èü•∂",
          rainy: "üåßÔ∏èüò¢",
          normal: "üå§Ô∏èüòä",
        };
        return characters[status] || characters.normal;
      }

      function getStatusText(status) {
        const texts = {
          hot: "‚òÄÔ∏è Quente! Est√° muito sol!",
          cold: "‚ùÑÔ∏è Frio! Bem geladinho!",
          rainy: "üåßÔ∏è Chuvoso! Molhadinho!",
          normal: "üå§Ô∏è Clima agrad√°vel!",
        };
        return texts[status] || texts.normal;
      }

      async function getPrevisao() {
        const bairro = document.getElementById("bairro").value;

        if (!bairro) {
          alert("Por favor, preencha o nome do bairro!");
          return;
        }

        try {
          // Primeiro, buscar as coordenadas do bairro usando Geocoding
          const geocodingResponse = await fetch(
            `https://geocoding-api.open-meteo.com/v1/search?name=${bairro}&count=1&language=pt&format=json`
          );
          const geocodingData = await geocodingResponse.json();

          if (!geocodingData.results || geocodingData.results.length === 0) {
            alert("Bairro n√£o encontrado! Tente outro nome.");
            return;
          }

          const location = geocodingData.results[0];
          const lat = location.latitude;
          const long = location.longitude;
          const nomeLugar = `${location.name}, ${
            location.admin1 || location.country
          }`;

          // Atualizar o t√≠tulo com o local encontrado
          document.getElementById("localName").innerText = `üìç ${nomeLugar}`;

          // Agora buscar a previs√£o com essas coordenadas
          const response = await fetch(
            `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${long}&hourly=temperature_2m,rain&timezone=auto`
          );
          const data = await response.json();

          console.log(data);
          const resposta = document.getElementById("resposta");
          resposta.innerHTML = "";

          // Mostrar os pr√≥ximos 24 dados
          const limit = Math.min(24, data.hourly.time.length);

          for (let index = 0; index < limit; index++) {
            const temp = data.hourly.temperature_2m[index];
            const rain = data.hourly.rain[index];
            const status = getWeatherStatus(temp, rain);
            const character = getCharacter(status);
            const time = new Date(data.hourly.time[index]).toLocaleTimeString(
              "pt-BR",
              { hour: "2-digit", minute: "2-digit" }
            );

            resposta.innerHTML += `
              <div class="weather-item ${status}">
                <div class="time">${time}</div>
                <div class="character" style="font-size: 60px; margin: 15px 0;">${character}</div>
                <div class="temp">${temp}¬∞C</div>
                <div class="rain">üåßÔ∏è ${rain} mm</div>
              </div>
            `;
          }

          alert("Dados de previs√£o carregados com sucesso!");
        } catch (error) {
          alert("Erro ao obter previs√£o: " + error.message);
        }
      }

      function displayMainWeather() {
        // Exemplo de exibi√ß√£o do personagem principal
        const temp = 25;
        const rain = 0;
        const status = getWeatherStatus(temp, rain);
        const character = getCharacter(status);

        document.getElementById("mainCharacter").innerHTML = character;
        document.getElementById(
          "mainCharacter"
        ).className = `character-display ${status}`;
        document.getElementById("statusText").innerText = getStatusText(status);
      }

      window.addEventListener("load", displayMainWeather);
    </script>
  </head>
  <body>
    <div class="container">
      <div class="weather-container">
        <h1 class="title">üåç Previs√£o do Tempo</h1>

        <!-- Personagem Principal -->
        <div class="info-card">
          <div id="mainCharacter" class="character-display"></div>
          <div id="statusText" class="status-text"></div>
        </div>

        <!-- Formul√°rio -->
        <div class="mt-4">
          <div class="mb-3">
            <label for="bairro" class="form-label"
              ><strong>üìç Nome do Bairro ou Cidade</strong></label
            >
            <input
              type="text"
              class="form-control"
              id="bairro"
              placeholder="Ex: Pinheiros, S√£o Paulo"
            />
          </div>

          <button
            type="button"
            class="btn btn-primary btn-lg"
            onclick="getPrevisao()"
          >
            üîç Verificar Previs√£o
          </button>
        </div>

        <!-- Nome do local -->
        <div id="localName" class="status-text" style="margin-top: 20px"></div>

        <!-- Grid de Previs√£o -->
        <div id="resposta" class="weather-grid"></div>
      </div>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
      integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.min.js"
      integrity="sha384-G/EV+4j2dNv+tEPo3++6LCgdCROaejBqfUeNjuKAiuXbjrxilcCdDz6ZAVfHWe1Y"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
